--DDL   -> CREATES INFRASTRUCTURE

CREATE DATABASE SENAI_13

USE SENAI_13

	/* UNIQUE IDENTIFIER -> for GUID */
CREATE TABLE Users (
	UsuarioID UNIQUEIDENTIFIER PRIMARY KEY default NEWID(),
	Email VARCHAR(100) UNIQUE NOT NULL,
	Senha VARCHAR(255) NOT NULL
)

CREATE TABLE Classes (
	ClasseId UNIQUEIDENTIFIER PRIMARY KEY default NEWID(),
	Nome VARCHAR(50) UNIQUE NOT NULL,
	Descricao VARCHAR(255) NOT NULL
)

CREATE TABLE Personagem (
	PersonagemID UNIQUEIDENTIFIER PRIMARY KEY default NEWID(),
	NomePersonagem VARCHAR(15) UNIQUE NOT NULL,
	UsuarioID UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Users(UsuarioID),
	ClassID UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Classes(ClasseId)
)

CREATE TABLE Habilidades (
	HabilidadeID UNIQUEIDENTIFIER PRIMARY KEY default NEWID(),
	Nome VARCHAR(100) UNIQUE NOT NULL
)

CREATE TABLE HabilidadesClasse (
	ClasseID UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Classes(ClasseId),
	HabilidadeID UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Habilidades(HabilidadeID)
)

-- DML  -> MANIPULATES DATA

INSERT INTO Users VALUES (default, 'ta@email.com', 'tati'), (default, 'barril@email.com', HASHBYTES('SHA2_512', 'barril'))
INSERT INTO Classes VALUES (default, 'Otame','she really likes manga and anime'), (default, 'Fanfic-writer', 'she really likes fanfic')
INSERT INTO Habilidades VALUES (default, 'kpop'), (default, 'reads a lot'), (default, 'Loves M/M')
INSERT INTO Personagem VALUES (default, 'LadyVoldermot', '1178CA19-8E00-4E51-9A1F-97B2DB9DB6CA', 'F76EC167-C736-4244-8006-915416D5A1F8')
INSERT INTO HabilidadesClasse VALUES ('F76EC167-C736-4244-8006-915416D5A1F8', 'DDFBEE7E-23C3-43E4-B499-9E17C9D85CD8'), ('F76EC167-C736-4244-8006-915416D5A1F8', '169DE197-9FD5-4BBB-B8B7-43A414065C0C'), ('E2E592D0-75FD-40F0-A559-7E2FA26ADB6F', '169DE197-9FD5-4BBB-B8B7-43A414065C0C')

ALTER TABLE Personagem
ALTER COLUMN NomePersonagem VARCHAR(50)

UPDATE Classes
SET Nome = 'Otome'
WHERE ClasseId = 'E2E592D0-75FD-40F0-A559-7E2FA26ADB6F' 


-- DQL  -> QUERY

SELECT * FROM Users
SELECT * FROM Classes
SELECT * FROM Habilidades
SELECT * FROM Personagem
SELECT * FROM HabilidadesClasse

SELECT * FROM Personagem
LEFT JOIN Classes
ON Personagem.ClassID = Classes.ClasseId